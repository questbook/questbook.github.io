<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Questbook Invite Links: The web3 OTP | Questbook official blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="The Problem Web3 is a nascent stack, and a major challenge dApps like QuestBook face is educating users about web3 terminology and delivering products that are easy to use products as well as decentralised.
One of QuestBook&rsquo;s workflows allowed DAOs to invite their team members to their organisation on QuestBook. However, to add the user to their organisation on chain, the organisation owner had to ask their team for their respective wallet addresses &ndash; which can feel unnatural, since wallet addresses have no easy-to-remember pattern like email addresses do."><meta name=generator content="Hugo 0.101.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="Questbook Invite Links: The web3 OTP"><meta property="og:description" content="The Problem Web3 is a nascent stack, and a major challenge dApps like QuestBook face is educating users about web3 terminology and delivering products that are easy to use products as well as decentralised.
One of QuestBook&rsquo;s workflows allowed DAOs to invite their team members to their organisation on QuestBook. However, to add the user to their organisation on chain, the organisation owner had to ask their team for their respective wallet addresses &ndash; which can feel unnatural, since wallet addresses have no easy-to-remember pattern like email addresses do."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.questbook.xyz/posts/questbook-invite-links/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-30T18:00:10+05:30"><meta property="article:modified_time" content="2022-07-30T18:00:10+05:30"><meta itemprop=name content="Questbook Invite Links: The web3 OTP"><meta itemprop=description content="The Problem Web3 is a nascent stack, and a major challenge dApps like QuestBook face is educating users about web3 terminology and delivering products that are easy to use products as well as decentralised.
One of QuestBook&rsquo;s workflows allowed DAOs to invite their team members to their organisation on QuestBook. However, to add the user to their organisation on chain, the organisation owner had to ask their team for their respective wallet addresses &ndash; which can feel unnatural, since wallet addresses have no easy-to-remember pattern like email addresses do."><meta itemprop=datePublished content="2022-07-30T18:00:10+05:30"><meta itemprop=dateModified content="2022-07-30T18:00:10+05:30"><meta itemprop=wordCount content="841"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Questbook Invite Links: The web3 OTP"><meta name=twitter:description content="The Problem Web3 is a nascent stack, and a major challenge dApps like QuestBook face is educating users about web3 terminology and delivering products that are easy to use products as well as decentralised.
One of QuestBook&rsquo;s workflows allowed DAOs to invite their team members to their organisation on QuestBook. However, to add the user to their organisation on chain, the organisation owner had to ask their team for their respective wallet addresses &ndash; which can feel unnatural, since wallet addresses have no easy-to-remember pattern like email addresses do."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Questbook official blog</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Questbook Invite Links: The web3 OTP</h1><time class="f6 mv4 dib tracked" datetime=2022-07-30T18:00:10+05:30>July 30, 2022</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h2 id=the-problem>The Problem</h2><p>Web3 is a nascent stack, and a major challenge dApps like QuestBook face is educating users about web3 terminology and delivering products that are easy to use products as well as decentralised.</p><p>One of QuestBook&rsquo;s workflows allowed DAOs to invite their team members to their organisation on QuestBook. However, to add the user to their organisation on chain, the organisation owner had to ask their team for their respective wallet addresses &ndash; which can feel unnatural, since wallet addresses have no easy-to-remember pattern like email addresses do.</p><p>We received a lot of feedback on the above mentioned flow from DAOs asking if there&rsquo;s a way for them to add their members via email or generate an invite link to send their team. Realising this is a UX problem we need to resolve for our users, we got to work.</p><h2 id=coming-up-with-a-solution>Coming Up With a Solution</h2><p>To allow users to invite by email, we&rsquo;d need to verify that the wallet wanting to join the organisation actually owned the email address that was invited. This entire flow had be on-chain and we couldn&rsquo;t think of a sane way to accomplish verifying the email on chain. So, we decided to tackle the invite link flow. Could we generate an invite link that an organisation owner can share with their team member, which they can use to join the organisation? And can we accomplish this purely on-chain?</p><p>We believed we could make it work somehow, and so we came up with a few approaches.</p><p>The inviter could hash a secret and then include the secret in the invite link and send this across to the invitee. The invitee would then pass the secret to the smart contract, which could then hash and check if the secret matched, if it does &ndash; we accept the invite and the user joins the DAO. Voila, on chain invites.</p><p>The problem with the above approach was that it could be front run, anybody observing the transaction could pay more gas and wrongly get into the organisation.</p><h2 id=the-solution>The Solution</h2><p>To resolve this front running problem, we thought of using public/private key crypto and so, we came up with the following framework &ndash; labelling it &ldquo;Anon Authoriser&rdquo;:</p><ol><li>Let&rsquo;s assume Alice wants to authorise Bob to take a certain action. In this case, Alice is the authoriser.</li><li>Alice Creates a public-private key pair <code>(Pu, Pr)</code> & compute address <code>A = Address(Pu)</code>.<ul><li>Note: your ETH address is a function of your public key &ndash; which is <code>A</code> in this case</li></ul></li><li>She denotes the purpose of the authorisation with a flag F. This flag prevents Bob from using Alice&rsquo;s authorisation to undertake another action that she hasn&rsquo;t authorised<ul><li>In our invite link case, the flag can be the hash of the organisation and role the invited user would undertake. This prevents misuse of the same invite.</li></ul></li><li>She then asks the SC (smart contract) to store this as a pending authorisation with the call: <code>generateAnonAuthorisation(A, F)</code></li><li>SC stores Alices wallet <code>Wa</code> and flag F against the address A</li><li>SC ensures this address hasn&rsquo;t been used already & returns successfully</li><li>Alice sends Bob her wallet address, the private key and authorisation flag (Wa, Pr, F)</li><li>Bob signs his wallet address (<code>Wb</code>) using <code>Pr</code> <code>S = Sign(Wb, Pr)</code></li><li>Bob requests the SC to verify authorisation using <code>anonAuthorise(Wa, F, S)</code></li><li>Solidity signature check returns the address that signed the message. The SC uses this to verify the signature sent by Bob, the message being Bob&rsquo;s wallet address <code>A' = Verify(Wb, S)</code></li><li>SC checks if there is a record stored against <code>A'</code></li><li>Finally, SC checks that the authoriser specified (<code>Wa</code> in this case)
and the flag of purpose F specified match the existing record.</li><li>If everything matches, SC returns successfully and deletes the record
so it cannot be used again</li><li>Bob is now considered authorised.<ul><li><code>Pr</code> can even be published online as it cannot be used now</li></ul></li><li>Note: this entire approach cannot be front run because in order to do that, another user would need to sign their wallet address &ndash; for which they&rsquo;d need the private key, and that they don&rsquo;t have access to.</li></ol><p><img src=../images/anon_authoriser_flow.png alt="Anon Authoriser Flow"></p><h2 id=the-labour>The Labour</h2><p>Once we had a framework in mind, we had to prove this works & so we built out this approach in a solidity smart contract, which you can access <a href=https://github.com/questbook/anon-authoriser>here</a>. This repo contains the SC & JS utils required to utilise anon-authoriser.</p><p>Then, we incorporated this flow into our grants smart contract to truly enable this invite link flow in our dApp. You can find the PR for the implementation <a href=https://github.com/questbook/grants-contracts-upgradeable/pull/14>here</a></p><p>Finally, the last leg of the solution was building out the frontend to interact with this SC, which you can find <a href=https://github.com/questbook/grants-frontend/pull/420>here</a></p><h2 id=the-fruit>The Fruit</h2><p>Our theory worked, we now had a secure, fully decentralised way to generate invite links on chain. We built the web3 equivalent of an OTP. You can create a DAO on QuestBook and <a href=https://www.beta.questbook.app/>try it out</a> now!</p><h3 id=preview>Preview</h3><p>What it looks like to create an anon-authoriser link</p><p><img src=../images/create_invite_link.png alt="Create Invite Link">
<img src=../images/created_invite_link.png alt="Created Invite Link"></p><p>What it looks like to join an anon-authoriser link</p><p><img src=../images/join_invite_link.png alt="Join Invite Link">
<img src=../images/joining_invite_link.png alt="Joining Invite Link"></p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://blog.questbook.xyz/>&copy; Questbook official blog 2022</a><div><div class=ananke-socials></div></div></div></footer></body></html>